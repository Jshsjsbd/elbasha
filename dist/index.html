<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mystic Network</title>
  </head>
  <body>
    <div id="root"></div>
    <script>
      (async () => {
        try {
          // Load the manifest to find the correct entry.client file
          console.log('Loading manifest from /.vite/manifest.json');
          const manifestRes = await fetch('/.vite/manifest.json');
          if (!manifestRes.ok) {
            throw new Error(`Failed to fetch manifest: ${manifestRes.status} ${manifestRes.statusText}`);
          }
          const manifest = await manifestRes.json();
          console.log('Manifest loaded:', manifest);
          
          const entryData = manifest['app/entry.client.tsx'];
          if (!entryData) {
            throw new Error('entry.client not found in manifest. Keys: ' + Object.keys(manifest).join(', '));
          }
          
          const entryFile = entryData.file;
          console.log('Found entry.client file:', entryFile);
          
          // Dynamically load the entry.client script
          const script = document.createElement('script');
          script.type = 'module';
          script.src = '/' + entryFile;  // entryFile already includes 'assets/' prefix
          
          script.onerror = (err) => {
            console.error('Script load error:', err);
            document.body.innerHTML = '<div style="color: red; padding: 20px; font-family: monospace; white-space: pre-wrap;">Failed to load application<br>' + (err?.message || 'Unknown error') + '</div>';
          };
          
          // Listen for errors from the loaded module
          window.addEventListener('error', (err) => {
            console.error('Global error:', err);
          });
          
          console.log('Loading script:', script.src);
          document.body.appendChild(script);
        } catch (err) {
          console.error('Failed to bootstrap app:', err);
          document.body.innerHTML = '<div style="color: red; padding: 20px; font-family: monospace; white-space: pre-wrap;">Error loading application:<br>' + err.message + '</div>';
        }
      })();
    </script>
  </body>
</html>
